var m=Object.defineProperty;var b=(n,r,t)=>r in n?m(n,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[r]=t;var d=(n,r,t)=>(b(n,typeof r!="symbol"?r+"":r,t),t);class f extends HTMLElement{constructor(){var t;super();d(this,"shadow");d(this,"actionForm",this.closest("action-form"));this.shadow=this.attachShadow({mode:"open"}),(t=this.actionForm)!=null&&t.steps&&(this.actionForm.addEventListener("af-step",()=>{this.render()}),this.render(),this.shadow.addEventListener("click",e=>{const s=e.target;if(s instanceof HTMLButtonElement&&s.matches(".step")&&!s.disabled){const i=Number(s.dataset.index||0);this.dispatchEvent(new CustomEvent("af-step",{bubbles:!0,composed:!0,detail:{step:i}})),this.render()}}))}get stepIndex(){var t;return((t=this.actionForm)==null?void 0:t.stepIndex)||0}render(){var o,a,u;if(!((o=this.actionForm)!=null&&o.steps))return;const t=Array.from(this.actionForm.steps).filter(l=>l.style.display!=="none").length,e=((a=this.actionForm)==null?void 0:a.stepIndex)||0,s=e/(t-1)*100,i="<style>:host{display:grid;position:relative;align-items:center;--step-border-size:.22em;--step-bg:white;--step-text:inherit;--inactive:lightgray;--active:lightseagreen;--invalid:coral;--valid:var(--active);--valid-bg:var(--active);--valid-text:white}.progress{background:var(--active);height:.5em;grid-row:-1/1;grid-column:-1/1}nav{margin:0;padding:0;list-style:none;display:flex;justify-content:space-between;grid-row:-1/1;grid-column:-1/1}.bg{background:var(--inactive);height:.5em;grid-row:-1/1;grid-column:-1/1}.step{border:var(--step-border-size) solid var(--inactive);border-radius:100%;width:2em;height:2em;line-height:1.65em;text-align:center;background:var(--step-bg);font-size:.9em;position:relative;z-index:1;padding:0;margin:0;cursor:pointer;color:var(--step-text)}.valid:has(~ .active){border-color:var(--valid);background:var(--valid-bg);color:var(--valid-text)}.step:disabled{opacity:1;cursor:not-allowed}.active{border-color:var(--active)}.step:not(.valid):has(~ .active){border-color:var(--invalid)}</style>";this.shadow.innerHTML=`${i}
        <div class="bg" part="bg"></div>
        <div class="progress" part="progress" style="width: ${s}%;"></div>
        <nav part="nav">
        ${Array.from((u=this.actionForm)==null?void 0:u.steps).filter(l=>l.style.display!=="none").map((l,c)=>{const h=c===e?"active":"",p=l.valid?"valid":"",v=this.hasAttribute("enable-all")||e>c?"":"disabled",g=l.dataset.title||"";return`<button type="button" part="step ${p} ${h}" ${v} title="${g}" class="step ${p} ${h}" ${h&&'aria-current="step"'} aria-label="Step ${c+1}" data-index="${c}">${c+1}</button>`}).join("")}
        </nav>
        `}}customElements.define("af-progress",f);class x extends HTMLElement{constructor(){var t;super();d(this,"actionForm",this.closest("action-form"));this.addEventListener("change",()=>{this.valid=this.isValid}),this.addEventListener("click",e=>{const s=e.target;s instanceof HTMLButtonElement&&this.step(Number(s.dataset.direction||0))}),(t=this.actionForm)==null||t.addEventListener("af-step",e=>{e.detail||this.setButtonTexts()})}get valid(){return this.hasAttribute("valid")}set valid(t){t?this.setAttribute("valid",""):this.removeAttribute("valid")}get isValid(){const t=this.querySelector("af-group-count");let e=!0;return t&&(e=t.validity),e&&this.querySelectorAll(":invalid").length===0}getStepTitle(t=1){if(this.actionForm){let e=Number(this.dataset.index||0)+t;e=Math.max(0,Math.min(e,this.actionForm.steps.length-1));const s=Array.from(this.actionForm.steps).find(i=>i.dataset.index===String(e));return(s==null?void 0:s.dataset.title)||""}return""}get prev(){return this.getDataText("Prev",-1)}get next(){return this.getDataText("Next",1)}get submit(){return this.getDataText("Submit")}getDataText(t,e){var i;const s=`button${t}`;return this.dataset[s]||e&&this.getStepTitle(e)||((i=this.actionForm)==null?void 0:i.dataset[s])||t}step(t=1){if(t!==0){if(t>0){const e=this.querySelectorAll("input, select, textarea, af-group-count");if(!Array.from(e).every(i=>{const o=i.checkValidity();if(i.dispatchEvent(new Event("change",{bubbles:!0})),!o)if(i.matches("af-group-count")){const a=this.querySelector("input, select, textarea");a==null||a.focus()}else i.focus();return o}))return}this.dispatchEvent(new CustomEvent("af-step",{bubbles:!0,detail:{direction:t}}))}}connectedCallback(){this.valid=this.isValid;const t=document.createElement("nav");t.classList.add("af-step-nav"),t.setAttribute("part","step-nav"),t.setAttribute("aria-label","Step Navigation");const e=(o,a)=>`<button type="button" class="af-step-${a?"next":"prev"}" data-direction="${a?1:-1}" part="step-btn ${a?"next":"prev"}">${o}</button>`,s=this.classList.contains("first")?"<span></span>":e(this.prev,!1),i=this.classList.contains("last")?`<button type="submit" part="submit">${this.submit}</button>`:e(this.next,!0);t.innerHTML=`${s}${i}`,this.appendChild(t)}setButtonTexts(){this.querySelectorAll(".af-step-nav button[data-direction]").forEach(t=>{t.textContent=t.dataset.direction==="1"?this.next:this.prev})}}customElements.define("af-step",x);
//# sourceMappingURL=af-step.js.map
