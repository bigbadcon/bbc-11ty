<section class="mt-md" x-data="{ filter: $persist({favsOnly: false,openOnly: false}) }">
    <h2 class="font-serif text-3xl font-bold leading-none md:text-4xl text-header mb-base">Volunteer Shift List</h2>
    {% include 'components/volunteer-shifts-table-filter.njk' %}
    <table class="w-full text-sm leading-tight text-body">
        <thead>
            <tr>
                <th class="text-left pb-sm">Event Name</th>
                <th class="text-left pb-sm">Date Time</th>
                <th class="text-center pb-sm max-w-max">Dur</th>
                <th class="text-center pb-sm max-w-max">Spaces</th>
                <th class="w-8 text-center pb-sm" x-cloak x-show="isAuth">
                    <span class="cursor-pointer fav-star-header hover:bg-highlight" @click="filter.favsOnly = !filter.favsOnly" :class="filter.favsOnly && 'favved'"></span>
                </th>
            </tr>
        </thead>
        <tbody>
            {# favsOnly and timezone in x-data in html #}
            {% for event in eventData.volunteer %}
                {# isFav is in Alpine.data("global") #}
                {# TODO: test openOnly #}
                {# If only showing favs and is fav then show #}
                {# If only showing open and is open then show #}
                <tr x-data="eventInfo"
                x-cloak
                x-show="(!filter.favsOnly || isFav({{event.eventId}})) && (!filter.openOnly || spacesOpen > 0)"
                x-init="if (isAuth) getEventBooking({{event.eventId}}); $watch('isAuth', value => {if (value === true) getEvent({{event.eventId}})});">
                    {# Event Name #}
                    <td class="py-sm pr-sm">
                        <a href="/volunteer/{{event.eventSlug}}" class="font-bold transition-colors text-header hover:text-highlight">{{event.eventName | safe }}</a>
                    </td>
                    {# Event Start Date/Time #}
                    {# formatEventDate() is in scripts.js and returns html with date and time in seperate span tags #}
                    {# formatEventDate filter is in eleventy.js and returns html with date and time in seperate span tags #}
                    <td x-cloak x-show="timezone" x-html="formatEventDate('{{event.eventStartDateTime}}', timezone)">
                        <div class="flex flex-col py-sm gap-x-2xs sm:flex-row">{{ event.eventStartDateTime | formatEventDate | safe }}</div>
                    </td>
                    {# Event Duration #}
                    <td class="font-bold text-center py-sm px-xs">
                        {% eventDuration event.eventStartDateTime,
                        event.eventEndDateTime %}
                    </td>
                    {# Spaces #}
                    <td>
                        {# If booked add check mark, otherwise list number of spaces open #}
                        <div class="flex items-center justify-center py-sm">
                            <span 
                            style="width: 1.375rem; height: 1.375rem" 
                            class="block text-center border-2 rounded border-body" 
                            :class="spacesOpen === 0 && 'bg-card opacity-40'" 
                            x-text="(isBooked({{event.eventId}})) ? '&#10004;' : (typeof spacesOpen === 'number') ? spacesOpen : '{{event.metadata.Players}}'">{{ event.metadata.Players }}</span>
                        </div>
                    </td>
                    {# Fav Event Icon #}
                    <td x-cloak x-show="isAuth">
                        <span @click="toggleFav({{event.eventId}})" class="fav-star" :class="isFav({{event.eventId}}) && 'favved'"></span>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</section>